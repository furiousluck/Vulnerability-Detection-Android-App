package com.example.vulnerabilitydetection;

import android.app.Activity;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.view.animation.Animation;
import android.view.animation.AnimationUtils;
import android.widget.ArrayAdapter;
import android.widget.ImageView;
import android.widget.TextView;

import androidx.annotation.NonNull;
import androidx.annotation.Nullable;

import java.util.ArrayList;
import java.util.List;
import java.util.Locale;

public class AppAdapter extends ArrayAdapter<App> {
    private static final String TAG = "MyActivity";
    List<App> modelList;
    ArrayList<App> arrayList;
    public AppAdapter(Activity context , ArrayList<App> apps){
        super(context, 0, apps);
        this.modelList=apps;
        arrayList=new ArrayList<App>();
        this.arrayList.addAll(modelList);
    }

    @NonNull
    @Override
    public View getView(int position, @Nullable View convertView, @NonNull ViewGroup parent) {
        View listItemView = convertView;
        if(listItemView == null) {
            listItemView = LayoutInflater.from(getContext()).inflate(
                    R.layout.app_list_item, parent, false); // false implies listItemView till now not attached to the parent

        }

        App currentApp  =(App)getItem(position);

        TextView appTextView = (TextView) listItemView.findViewById(R.id.name);
        appTextView.setText(currentApp.getAppName());

        ImageView image = (ImageView) listItemView.findViewById(R.id.appIcon);
        image.setImageDrawable(currentApp.getIcon());
        // Make sure view is visible because if we use same layout file as we are using recycling concept there might be the case that previous layout image view visibility is set to GONE
        image.setVisibility(View.VISIBLE);

        Animation animation = AnimationUtils.loadAnimation(getContext().getApplicationContext(),R.anim.scale);
        listItemView.setAnimation(animation);

        return listItemView;
    }
    public void filter(String charText){
        charText=charText.toLowerCase(Locale.getDefault());
        modelList.clear();
        if(charText.length()==0){
            modelList.addAll(arrayList);
        }
        else{
            for(App app:arrayList){
                if(app.getAppName().toLowerCase(Locale.getDefault()).contains(charText)){
                    modelList.add(app);

                }
            }
        }
      notifyDataSetChanged();
    }
}
